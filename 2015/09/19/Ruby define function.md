# Ruby入门系列7——定义函数（方法） #

虽然很多地方都由于Ruby是完全面向对象的编程语言，这里把function都直接翻译为方法。可我觉得function和method还是需要都介绍下。

这里我们先介绍函数function，方法method与它的使用完全类似。

## 函数定义 ##

函数定义的语法如下：

	def 方法名 [`(' [arg ['=' default]] ... [`,' `*' arg] [',' '&' arg]`)']
	  表达式..
	[rescue [error_type,..] [=> evar] [then]
	  表达式..]..
	[else
	  表达式..]
	[ensure
	  表达式..]
	end

在定义语句所在的区域内定义一个函数（方法）。也就是说，如果在类/模块的定义部分内定义一个方法的话，该方法就属于这个类/模块。若在顶层定义了一个方法的话，您就可以在任意地方调用它，也就是函数。

方法名中，除了可以使用通常的标识符以外，还可以使用可重载的操作符（==，+，-等等）。

若给形参指定了默认表达式的话，在方法调用过程中如果实参被省略时，该默认表达式的值就会变成默认值被调用。

若最后一个形参的前面带‘*’号的话，所有剩下的实参将被转为数组后传递给该参数。

若最后一个形参前面带‘&’号的话，表示传递给该参数的块是一个过程对象。这是定义迭代器的一种方法。当没有给出块时，块参数的值为nil。

在方法定义中，只能以下列顺序指定形参，其中任何一项都是可选的。

* 没有默认表达式的参数（可多选）
* 有默认表达式的参数（可多选）
* 带*的表达式（只能有一个）
* 带&的表达式（只能有一个）

## 方法的返回值 ##

在方法中使用return语句，可以指定返回值。

	return value

如：设计一个计算立方体体积的方法。参数是x、y、z三个方向的边长。

```ruby
def volumn(x, y, z)
  return x * y * z
end

p volumn(2, 3, 4)    # => 24
p volumn(10, 20, 30) # => 6000
```

return语句可以省略，这时方法中最后一个语句的计算值是返回值。在前面的示例基础上，下面再试着定义一个用来计算立方体表面积的方法。

```ruby
def area(x, y, z)
  xy = x * y
  yz = y * z
  xz = z * x
  (xy + yz + zx) * 2
end

p area(2, 3, 4)     # => 52
p area(10, 20, 30)  # => 2200
```

方法的返回值不一定是最后一行。要看实际情况：

```ruby
def max(a, b)
  if a > b
    a
  else
    b
  end
end

p max(10, 5)
```

虽然可以省略，但似乎return语句直接跳出方法很有用。上面这个例子我们这么写：

```ruby
def max(a, b)
  if a > b
    return a
  end
  return b  # 这里return省略掉也可
end

p max(10, 5)
```

另外，省略return的实参时，则会返回nil。